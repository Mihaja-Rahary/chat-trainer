<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Login OFM Chat Trainer</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
body { margin:0; font-family:'Roboto',sans-serif; background: linear-gradient(to right,#ff5f6d,#ffc371); display:flex; justify-content:center; align-items:center; height:100vh; color:#fff;}
.card { background: rgba(0,0,0,0.85); padding:40px; border-radius:15px; width:400px; text-align:center; box-shadow:0 10px 25px rgba(0,0,0,0.5);}
h2 { margin-bottom:20px; font-weight:700;}
input { width:100%; padding:12px; margin:10px 0; border-radius:8px; border:none; font-size:14px;}
button { width:100%; padding:12px; margin-top:10px; border:none; border-radius:8px; background:#ff5f6d; font-size:16px; font-weight:700; cursor:pointer; transition:0.3s; color:#fff;}
button:hover { background:#ff8a75; }
p { font-size:14px; margin-top:10px;}
</style>
</head>
<body>

<div class="card">
  <h2>Connexion</h2>
  <input type="email" id="email" placeholder="Email" required/>
  <input type="password" id="password" placeholder="Mot de passe" required/>
  <button onclick="login()">Se connecter</button>
  <p id="msg"></p>
</div>

<script>
async function login(){
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();
  if(!email || !password){ document.getElementById("msg").innerText="Merci de remplir tous les champs."; return; }

  const res = await fetch("/api/auth",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({type:"login",email,password})
  });
  const data = await res.json();

  if(data.error){
    document.getElementById("msg").innerText = data.error;
    return;
  }

  // Stockage local
  localStorage.setItem("username", data.username);
  localStorage.setItem("role", data.role);
  localStorage.setItem("token", data.token);

  // Redirection selon r√¥le
  if(data.role === "superadmin"){
      window.location.href = "superadmin-dashboard.html";
  } else if(data.role === "admin"){
      window.location.href = "admin-dashboard.html";
  } else {
      window.location.href = "app.html";
  }
}
</script>

</body>
</html>
